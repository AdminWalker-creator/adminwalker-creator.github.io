<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>A_W Community Chat</title>

<style>
    body {
        margin: 0;
        background: #020814;
        color: white;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    h1 {
        text-align: center;
        padding: 15px 0;
    }

    #chat-box {
        flex: 1;
        overflow-y: auto;
        background: #0b1426;
        border: 2px solid #00c4a8;
        margin: 0 15px;
        padding: 10px;
        border-radius: 10px;
    }

    .msg {
        background: #112039;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 8px;
        word-wrap: break-word;
    }

    .username {
        font-weight: bold;
        color: #00c4a8;
    }

    #input-area {
        display: flex;
        padding: 10px;
        background: #0b1426;
    }

    #name-input, #message-input {
        flex: 1;
        margin-right: 10px;
        padding: 10px;
        border-radius: 6px;
        border: none;
        outline: none;
    }

    #send-btn {
        padding: 10px 20px;
        background: #00c4a8;
        border: none;
        border-radius: 6px;
        font-weight: bold;
        cursor: pointer;
    }

    #send-btn:hover {
        background: #00e2c2;
    }
</style>
</head>

<body>

<h1>A_W Community Chat</h1>

<div id="chat-box"></div>

<div id="input-area">
    <input type="text" id="name-input" placeholder="Your name..." />
    <input type="text" id="message-input" placeholder="Type a message..." />
    <button id="send-btn">Send</button>
</div>

<!-- FIREBASE SCRIPTS -->
<script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp, onSnapshot, query, orderBy } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCUw599ZSYdjmv5uJFgsxyRW16Fs9ef4Qg",
      authDomain: "aw-community-chat.firebaseapp.com",
      projectId: "aw-community-chat",
      storageBucket: "aw-community-chat.firebasestorage.app",
      messagingSenderId: "753015399762",
      appId: "1:753015399762:web:50e8094b2d0cf4a344c68b"
    };

    // Init Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const chatBox = document.getElementById("chat-box");
    const nameInput = document.getElementById("name-input");
    const messageInput = document.getElementById("message-input");
    const sendBtn = document.getElementById("send-btn");

    // Send message
    sendBtn.onclick = async () => {
        const name = nameInput.value.trim();
        const text = messageInput.value.trim();
        if (name === "" || text === "") return;

        await addDoc(collection(db, "messages"), {
            name: name,
            text: text,
            time: serverTimestamp()
        });

        messageInput.value = "";
    };

    // Live update messages
    const q = query(collection(db, "messages"), orderBy("time"));
    onSnapshot(q, (snapshot) => {
        chatBox.innerHTML = "";
        snapshot.forEach((doc) => {
            const msg = doc.data();

            const div = document.createElement("div");
            div.className = "msg";
            div.innerHTML = `
                <div class="username">${msg.name}</div>
                <div>${msg.text}</div>
            `;
            chatBox.appendChild(div);
        });

        chatBox.scrollTop = chatBox.scrollHeight;
    });
</script>

</body>
</html>
